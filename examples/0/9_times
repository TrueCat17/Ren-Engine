Переключение времени.

В Ren-Engine есть переключение между разными временами суток.

Эти времена позволяют использовать дополнительные изображения для локаций, персонажей и объектов на них или менять оттенки основных изображений, если дополнительные отсутствуют.
Также они влияют и на обычные ВН-спрайты, если они зарегистрированы нужным образом.


Итак, регистрация времени делается так:
$ make_time('name', text, sprite, location)
Где name - название времени, будет создана функция name_time,
    text - текст, который будет показываться в переходе локации от одного времени к другому (только если отображается какая-то локация),
    sprite - параметры для изменения ВН-спрайтов,
    location - параметры для изменения RPG-объектов (локации, объекты локаций, персонажи).
Параметры location применяются в функции im.recolor, sprite - обычно тоже, хотя вы можете это и изменить.

Например, так можно зарегистрировать ночное время:
$ make_time('night', text = 'Наступает ночь', sprite=(160, 200, 210), location=(140, 180, 210))

Следует обратить внимание на то, что после названия здесь допускаются только именованные аргументы, т. е. код
$ make_time('night', 'Наступает ночь', (160, 200, 210), (140, 180, 210))
не является допустимым.

Установить ночь в сценарии можно будет так:
$ night_time()
Это соответствующим образом изменит изображения.

Все RPG объекты при этом будут пытаться брать изображения с постфиксом _night.
Например, не images/locations/wood/main.png, а images/locations/wood/main_night.png
Или не images/characters/me_form.png, а images/characters/me_form_night.png

Если нужное изображение не существует, будет использован результат функции im.recolor к оригинальному изображению с нужными параметрами.
Т. е. если не будет найден файл images/characters/me_form_night.png,
 то будет использован результат im.recolor('images/characters/me_form.png', 140, 180, 210)


ВН-спрайты являются одним и тем же изображением, у которого допустимо лишь менять оттенки.
Причём для этого спрайт должен быть зарегистрирован специальным образом.

Вместо, например, 
image rn normal = 'images/sprites/rn/normal.png'
следует сделать
image rn normal = im.recolor('images/sprites/rn/normal.png', *sprite_time_rgb)

Переменная sprite_time_rgb содержит то, что было передано в параметре sprite при регистрации текущего времени.
* в питоне раскрывает список, и его содержимое передаётся как набор отдельных параметров, т. е. с таким же успехом можно было бы написать:
image rn normal = im.recolor('images/sprites/rn/normal.png', sprite_time_rgb[0], sprite_time_rgb[1], sprite_time_rgb[2])
Но я всё же рекомендую более короткий и удобный способ.

Название текущего времени хранится в times['current_name'].


По-умолчанию существует только время с названием day, зарегистрированного так:
make_time('day')
Т. к. ничего, кроме названия тут не задано, все остальные параметры принимают значения по-умолчанию:
	text = 'The ' + name + ' is coming' = 'The day is coming',
	sprite = (255, 255, 255),
	location = (255, 255, 255).

Напомню, что вызов im.recolor с параметрами 255, 255, 255 не делает ничего и сразу же возвращает изначальное изображение.
Поэтому время day можно считать игнорированием системы переключения времени.
Конечно, за исключением случая, когда у какого-то RPG-объекта есть изображение в постфиксом _day.

Т. к. время это регистрируется в одном из файлов в директории mods/engine/, в котором что-то изменять нежелательно, существует функция
$ set_time_text('time_name', 'Text')
для изменения отображаемого текста уже зарегистрированного времени.
Поэтому изменить текст времени day можно так:
$ set_time_text('day', 'Наступает день')


В демке движка и в шаблонах для новых игр есть файл mods/common/std_resources/times.rpy с содержимым вида
init -1000 python:
	set_time_text('day', 'Наступает день') # set text for RPG in day_time
	
	make_time('sunset', text = 'Наступает вечер', sprite=(240, 210, 255), location=(240, 210, 255)) # make def sunset_time
	make_time('night',  text = 'Наступает ночь',  sprite=(160, 200, 210), location=(140, 180, 210)) # night_time

Как видно, здесь меняется текст между переключениями временами локации при наступлении дня и регистрируются времена sunset (закат) и night (ночь).
Если нужны ещё какие-то времена, то их желательно создавать именно здесь.

